<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.demo.spring_demo.mapper.TeamMapper">
    
    <!-- 查询单个团队 -->
    <select id="findById" resultType="com.demo.spring_demo.model.Team">
        SELECT * FROM team WHERE id = #{id}
    </select>

    <!-- 查询所有团队 -->
    <select id="findAll" resultType="com.demo.spring_demo.model.Team">
        SELECT * FROM team
    </select>

    <!-- 插入新团队 -->
    <insert id="insert" parameterType="com.demo.spring_demo.model.Team">
        INSERT INTO team (id, name, com_id, captain_id, captain_name, status, create_time, member_names, instructor_names)
        VALUES (#{id}, #{name}, #{comId}, #{captainId}, #{captainName}, #{status}, #{createTime}, #{memberNames}, #{instructorNames})
    </insert>

    <!-- 更新团队信息 -->
    <update id="updateTeam" parameterType="com.demo.spring_demo.model.Team">
        UPDATE team SET
            name = #{name},
            com_id = #{comId},
            captain_id = #{captainId},
            captain_name = #{captainName},
            status = #{status},
            member_names = #{memberNames},
            instructor_names = #{instructorNames}
        WHERE id = #{id}
    </update>

    <!-- 删除团队 -->
    <delete id="deleteById">
        DELETE FROM team WHERE id = #{id}
    </delete>

    <!-- 获取团队成员列表 -->
    <select id="getTeamMembers" resultType="com.demo.spring_demo.model.Member">
        SELECT * FROM member WHERE team_id = #{teamId}
    </select>

    <!-- 更新团队成员名字列表 -->
    <update id="updateTeamMemberNames">
        UPDATE team SET member_names = #{memberNames}
        WHERE id = #{teamId}
    </update>

    <!-- 获取团队导师列表 -->
    <select id="getTeamInstructors" resultType="com.demo.spring_demo.model.Instructor">
        SELECT * FROM instructor WHERE team_id = #{teamId}
    </select>

    <!-- 更新团队导师名字列表 -->
    <update id="updateTeamInstructorNames">
        UPDATE team SET instructor_names = #{instructorNames}
        WHERE id = #{teamId}
    </update>

    <!-- 插入新成员 -->
    <insert id="insertMember" parameterType="com.demo.spring_demo.model.Member">
        INSERT INTO member (id, name, student_id, team_id, academy_id, phone, is_captain, email)
        VALUES (#{id}, #{name}, #{studentId}, #{teamId}, #{academyId}, #{phone}, #{isCaptain}, #{email})
    </insert>

    <!-- 删除团队所有成员 -->
    <delete id="deleteTeamMembers">
        DELETE FROM member WHERE team_id = #{teamId}
    </delete>

    <!-- 插入新导师 -->
    <insert id="insertInstructor" parameterType="com.demo.spring_demo.model.Instructor">
        INSERT INTO instructor (id, name, work_code, team_id, academy_id, phone)
        VALUES (#{id}, #{name}, #{workCode}, #{teamID}, #{academyID}, #{phone})
    </insert>

    <!-- 删除团队所有导师 -->
    <delete id="deleteTeamInstructors">
        DELETE FROM instructor WHERE team_id = #{teamId}
    </delete>

    <!-- 根据ID查询成员 -->
    <select id="findMemberById" resultType="com.demo.spring_demo.model.Member">
        SELECT * FROM member WHERE id = #{id}
    </select>

    <!-- 根据ID查询导师 -->
    <select id="findInstructorById" resultType="com.demo.spring_demo.model.Instructor">
        SELECT * FROM instructor WHERE id = #{id}
    </select>

</mapper> 